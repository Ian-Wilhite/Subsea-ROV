version: "3.9"

services:
  obc:
    build:
      context: ..
      dockerfile: docker/obc/Dockerfile
      args:
        BASE_IMAGE: arm64v8/ubuntu:22.04
        ROS_DISTRO: ${ROS_DISTRO:-humble}
    image: subsea-rov/obc:dev
    platform: linux/arm64
    privileged: true
    network_mode: host
    volumes:
      - ../software/onboard:/workspace/app:ro
    environment:
      - WORKSPACE_SETUP=/workspace/app/setup.bash
    command: ["bash"]

  gcs:
    build:
      context: ..
      dockerfile: docker/gcs/Dockerfile
      args:
        BASE_IMAGE: arm64v8/ubuntu:22.04
        ROS_DISTRO: ${ROS_DISTRO:-humble}
    image: subsea-rov/gcs:dev
    platform: linux/arm64
    devices:
      - /dev/input:/dev/input
    volumes:
      - ../software/ground_station:/workspace/ui:ro
      - /tmp/.X11-unix:/tmp/.X11-unix
    environment:
      - DISPLAY=${DISPLAY}
    command: ["bash"]
